/* EchoNote 样式文件 */
@import "tailwindcss";

/* CSS 变量定义 - 浅色模式 */
:root {
    /* 主色调 */
    --color-primary: #007aff;
    --color-primary-hover: rgba(0, 122, 255, 0.1);
    --color-primary-light: rgba(0, 122, 255, 0.05);

    /* 强调色 */
    --color-success: #34c759;
    --color-success-light: rgba(52, 199, 89, 0.1);

    /* 文字颜色 */
    --color-text-primary: #1d1d1f;
    --color-text-secondary: #86868b;
    --color-text-tertiary: rgba(134, 134, 139, 0.4);
    --color-text-inverse: #ffffff;

    /* 背景颜色 */
    --color-bg-primary: #ffffff;
    --color-bg-secondary: rgba(255, 255, 255, 0.8);
    --color-bg-tertiary: rgba(255, 255, 255, 0.5);

    --color-bg-hover: rgba(0, 0, 0, 0.05);

    /* 边框颜色 */
    --color-border-primary: rgba(0, 0, 0, 0.05);
    --color-border-secondary: rgba(0, 0, 0, 0.1);
}

/* CSS 变量定义 - 深色模式 */
[data-theme="dark"] {
    /* 主色调 */
    --color-primary: #0a84ff;
    --color-primary-hover: rgba(10, 132, 255, 0.2);
    --color-primary-light: rgba(10, 132, 255, 0.1);

    /* 强调色 */
    --color-success: #30d158;
    --color-success-light: rgba(48, 209, 88, 0.2);

    /* 文字颜色 */
    --color-text-primary: #f5f5f7;
    --color-text-secondary: #98989d;
    --color-text-tertiary: rgba(152, 152, 157, 0.4);
    --color-text-inverse: #1d1d1f;

    /* 背景颜色 */
    --color-bg-primary: #1c1c1e;
    --color-bg-secondary: rgba(28, 28, 30, 0.9);
    --color-bg-tertiary: rgba(28, 28, 30, 0.85);

    --color-bg-hover: rgba(255, 255, 255, 0.1);

    /* 边框颜色 */
    --color-border-primary: rgba(255, 255, 255, 0.1);
    --color-border-secondary: rgba(255, 255, 255, 0.15);
}

/* Base layout + typography */
*,
*::before,
*::after {
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family:
        -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC",
        "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
    background:
        radial-gradient(circle at 10% 20%,
            rgba(0, 122, 255, 0.08),
            transparent 50%),
        linear-gradient(180deg, #f4f6fb, #fdfdfd);
    color: var(--color-text-primary);
    min-height: 100vh;
}

[data-theme="dark"] body {
    background:
        radial-gradient(circle at 10% 20%,
            rgba(10, 132, 255, 0.12),
            transparent 50%),
        #0d0f16;
}

:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
}

@layer components {
    .layout-shell {
        @apply min-h-screen flex flex-col;
        background:
            radial-gradient(circle at 10% 20%,
                rgba(0, 122, 255, 0.08),
                transparent 40%),
            radial-gradient(circle at 80% 0%,
                rgba(52, 199, 89, 0.08),
                transparent 45%);
    }

    [data-theme="dark"] .layout-shell {
        background:
            radial-gradient(circle at 15% 25%,
                rgba(10, 132, 255, 0.12),
                transparent 45%),
            radial-gradient(circle at 80% 0%,
                rgba(48, 209, 88, 0.08),
                transparent 50%),
            linear-gradient(180deg, #05060a, #0f1017);
    }

    .layout-shell__main {
        @apply flex-1 flex flex-col overflow-hidden min-h-0;
        padding: clamp(1.5rem, 4vw, 3.5rem);
    }

    .home {
        @apply flex flex-col gap-6 w-full max-w-[90rem] mx-auto flex-1 h-full min-h-0 overflow-hidden;
    }

    .home--portrait {
        @apply h-full overflow-hidden;
    }

    .home__hero {
        @apply flex items-center justify-between p-6 rounded-2xl border bg-[var(--color-bg-secondary)] border-[var(--color-border-primary)] flex-wrap gap-4 shadow-[0_20px_70px_rgba(15, 23, 42, 0.18)];
        backdrop-filter: blur(12px);
    }

    .home__eyebrow {
        @apply tracking-[0.15em] uppercase text-xs text-[var(--color-text-secondary)] mb-1;
    }

    .home__hero h1 {
        @apply text-[clamp(1.6rem, 3vw, 2.4rem)] mb-1;
    }

    .home__subtitle {
        @apply text-[var(--color-text-secondary)] text-sm;
    }

    .home__hero-actions {
        @apply flex gap-3;
    }

    .home__hero-actions button,
    .home__hero-actions a {
        @apply rounded-full px-6 py-2 font-semibold border border-[var(--color-border-primary)] no-underline text-[var(--color-text-primary)] bg-[var(--color-bg-primary)] cursor-pointer;
    }

    .home__hero-actions button {
        @apply bg-[var(--color-primary)] text-white border-transparent;
    }

    .home__layout {
        @apply flex gap-6 items-stretch min-h-0 flex-1 h-full overflow-hidden;
    }

    .home--portrait .home__layout {
        @apply flex-col gap-4;
    }

    .home__sidebar,
    .home__timeline {
        @apply rounded-3xl p-5 border border-[var(--color-border-primary)] bg-[var(--color-bg-secondary)] shadow-[0_25px_60px_rgba(15, 23, 42, 0.2)] w-full;
        backdrop-filter: blur(16px);
    }

    [data-theme="dark"] .home__hero,
    [data-theme="dark"] .home__sidebar,
    [data-theme="dark"] .home__timeline {
        box-shadow: 0 25px 65px rgba(0, 0, 0, 0.5);
    }

    .home__timeline {
        @apply flex flex-col gap-4 min-h-0 h-full max-h-full overflow-hidden flex-1;
        min-height: 520px;
        max-height: calc(100vh - 14rem);
    }

    .home__sidebar {
        @apply flex flex-col min-h-0 self-start;
        flex: 0 0 320px;
    }

    .home--portrait .home__sidebar {
        @apply flex-none w-full;
    }

    .home--portrait .home__timeline {
        @apply flex-1 min-h-0 overflow-hidden;
    }

    .home__timeline-actions {
        @apply flex justify-end flex-shrink-0;
    }

    .home__timeline-actions button {
        @apply border-none rounded-full px-5 py-2 cursor-pointer bg-[var(--color-primary)] text-white font-semibold;
    }

    .home__sidebar :global(.calendar) {
        @apply rounded-2xl overflow-auto;
        max-height: calc(100vh - 14rem);
    }

    .home__timeline :global(.timeline) {
        @apply h-full min-h-0;
    }

    .settings {
        @apply min-h-[calc(100vh-5rem)] py-4 w-full max-w-[90rem] mx-auto flex-1 overflow-y-auto flex;
    }

    .settings__panel {
        @apply w-full p-8 rounded-3xl border border-[var(--color-border-primary)] bg-[var(--color-bg-secondary)] shadow-[0_30px_80px_rgba(15, 23, 42, 0.22)];
        backdrop-filter: blur(18px);
    }

    .settings__panel header h1 {
        @apply mb-2;
    }

    .settings__panel header p {
        @apply text-[var(--color-text-secondary)] mb-6;
    }

    .settings__back {
        @apply inline-flex items-center gap-1 text-sm font-semibold text-[var(--color-primary)] no-underline;
    }

    .settings__back:hover {
        @apply underline;
    }

    .settings__grid {
        @apply grid gap-5;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    }

    .settings__choices {
        @apply flex flex-wrap gap-2;
    }

    .settings__choices button {
        @apply rounded-full border border-[var(--color-border-primary)] bg-transparent px-4 py-2 cursor-pointer font-semibold;
    }

    .settings__choices button.active {
        @apply bg-[var(--color-primary)] text-white border-transparent;
    }

    .settings__grid article {
        @apply rounded-2xl p-5 bg-[var(--color-bg-primary)] border border-[var(--color-border-primary)] flex flex-col gap-3;
    }

    .settings__grid article h2 {
        @apply text-base;
    }

    .settings__grid article p {
        @apply text-sm text-[var(--color-text-secondary)];
    }

    .editor-shell {
        @apply flex flex-col min-h-[calc(100vh-5rem)] w-full max-w-[80rem] mx-auto flex-1 border border-[var(--color-border-primary)] rounded-2xl gap-4 bg-[var(--color-bg-secondary)] shadow-[0_30px_80px_rgba(15, 23, 42, 0.2)] overflow-y-auto;
        padding: clamp(1rem, 3vw, 2.25rem);
    }

    [data-theme="dark"] .editor-shell {
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.55);
    }

    .editor-shell__toolbar {
        @apply flex items-center gap-4 flex-wrap;
    }

    .editor-shell__ghost-btn {
        @apply inline-flex items-center gap-1 text-sm font-medium rounded-full px-3 py-1 text-[var(--color-primary)] transition-colors;
        background: transparent;
        border: none;
        cursor: pointer;
    }

    .editor-shell__ghost-btn:hover {
        background: var(--color-primary-hover);
    }

    .editor-shell__date {
        @apply font-semibold text-[var(--color-text-primary)] flex-1 flex items-center gap-2 min-w-0 text-base;
    }

    .editor-shell__weekday {
        @apply text-sm text-[var(--color-text-secondary)];
    }

    .editor-shell__badge {
        @apply inline-flex items-center gap-2 text-xs px-3 py-1 rounded-full border border-[var(--color-border-primary)] text-[var(--color-text-secondary)];
        background: color-mix(in srgb, var(--color-bg-tertiary) 90%, transparent);
    }

    .editor-shell__dot {
        @apply w-2 h-2 rounded-full shadow-[0_0_10px_rgba(52, 199, 89, 0.6)];
        background: var(--color-success);
    }

    .editor-shell__body {
        @apply flex-1 flex;
    }

    .editor-shell__textarea {
        @apply w-full h-full border-none outline-none bg-transparent p-4 resize-none text-base leading-relaxed text-[var(--color-text-primary)];
    }

    .calendar {
        @apply flex flex-col gap-4 min-h-0 h-full overflow-auto;
    }

    .calendar__actions {
        @apply mt-2;
    }

    .calendar__actions button {
        @apply w-full rounded-[0.85rem] border border-[var(--color-border-primary)] px-4 py-2 text-sm text-[var(--color-text-secondary)] transition;
        background: transparent;
    }

    .calendar__actions button:hover:not(:disabled) {
        @apply text-[var(--color-primary)];
        border-color: color-mix(in srgb, var(--color-primary) 40%, transparent);
        background: color-mix(in srgb, var(--color-primary) 8%, transparent);
    }

    .calendar__actions button:disabled {
        @apply opacity-60 cursor-not-allowed text-[var(--color-text-tertiary)];
    }

    .calendar-section {
        @apply overflow-hidden;
        transition:
            max-height 0.3s ease,
            opacity 0.25s ease;
    }

    .calendar--static .calendar-section {
        transition: none;
    }

    .calendar-section--collapsed {
        max-height: 0;
        opacity: 0;
    }

    .calendar-section--expanded {
        max-height: 30rem;
        opacity: 1;
    }

    .entry-dot {
        @apply absolute bottom-1 w-1 h-1 rounded-full;
        left: 50%;
        transform: translateX(-50%);
        background: var(--color-success);
    }

    .calendar button {
        background: transparent;
    }

    .calendar button:focus-visible {
        @apply outline outline-2 outline-[var(--color-primary)] outline-offset-2;
    }

    .date-cell {
        @apply w-12 h-12 mx-auto rounded-full border border-[color-mix(in_srgb, var(--color-border-primary)_80%, transparent)] shadow-[0_10px_18px_rgba(15, 23, 42, 0.04), inset_0_1px_0_rgba(255, 255, 255, 0.5)] relative flex flex-col items-center justify-center transition-all duration-200 select-none;
        background:
            radial-gradient(circle at top,
                color-mix(in srgb, var(--color-primary) 12%, transparent),
                transparent 70%),
            rgba(255, 255, 255, 0.35);
    }

    [data-theme="dark"] .date-cell {
        background: rgba(30, 30, 34, 0.7);
        border-color: rgba(255, 255, 255, 0.08);
    }

    .timeline {
        @apply flex flex-col gap-5 h-full min-h-0;
    }

    .timeline__empty {
        @apply m-auto p-8 text-[var(--color-text-secondary)];
    }

    .timeline__list {
        @apply list-none p-0 m-0 flex flex-col gap-7 pr-2 overflow-y-auto flex-1 min-h-0;
    }

    .timeline__item {
        @apply grid items-center gap-5;
        grid-template-columns: 150px minmax(0, 1fr);
        scroll-margin-top: 2.5rem;
    }

    .timeline__axis {
        @apply relative flex flex-col gap-1 text-sm text-[var(--color-text-secondary)] pl-6;
    }

    .timeline__axis::after {
        content: "";
        position: absolute;
        top: 0.85rem;
        left: 0;
        right: -1.25rem;
        height: 2px;
        background: linear-gradient(90deg,
                rgba(0, 0, 0, 0.05),
                rgba(0, 122, 255, 0.4));
    }

    .timeline__dot {
        @apply absolute top-[0.45rem] left-0 w-3 h-3 rounded-full border-2 border-[var(--color-primary)];
        box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.12);
        background: #fff;
    }

    .timeline__card {
        @apply w-full border rounded-2xl p-5 text-left cursor-pointer transition;
        border-color: rgba(255, 255, 255, 0.35);
        background:
            radial-gradient(circle at 10% 20%,
                rgba(0, 122, 255, 0.08),
                transparent 60%),
            rgba(255, 255, 255, 0.9);
        box-shadow:
            0 20px 45px rgba(15, 23, 42, 0.08),
            inset 0 1px 0 rgba(255, 255, 255, 0.35);
        backdrop-filter: blur(16px);
    }

    [data-theme="dark"] .timeline__card {
        background: rgba(30, 30, 34, 0.9);
        border-color: rgba(255, 255, 255, 0.08);
    }

    [data-theme="dark"] .timeline__card--placeholder {
        background: rgba(30, 30, 34, 0.75);
        border-color: rgba(255, 255, 255, 0.12);
    }

    .timeline__card:hover {
        @apply -translate-y-1 shadow-[0_25px_60px_rgba(15, 23, 42, 0.16)];
    }

    .timeline__card--active {
        @apply border-[var(--color-primary)] -translate-y-0.5 shadow-[0_25px_60px_rgba(15, 23, 42, 0.2)];
    }

    .timeline__card--placeholder {
        @apply border-dashed border-[var(--color-border-secondary)] bg-white/60 min-h-[150px] flex items-center justify-center text-center;
    }

    .timeline__item--active .timeline__axis {
        @apply text-[var(--color-text-primary)];
    }

    .timeline__dot--active {
        @apply bg-[var(--color-primary)];
        box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.2);
    }

    .timeline__card-title {
        @apply flex items-center justify-between gap-3 mb-3 font-semibold;
    }

    .timeline__mood {
        @apply text-2xl;
    }

    .timeline__preview {
        @apply text-sm leading-relaxed text-[var(--color-text-primary)] opacity-80;
    }

    .timeline__summary {
        @apply mt-3 text-xs inline-flex items-center gap-1.5 px-3 py-2 rounded-lg;
        background: rgba(0, 122, 255, 0.08);
        border: 1px solid rgba(0, 122, 255, 0.12);
        color: var(--color-text-primary);
    }

    .timeline__placeholder {
        @apply flex flex-col gap-1 text-[var(--color-text-secondary)] text-center items-center;
    }
}